# Auto-generated by fogg. Do not edit
# Make improvements in fogg, so that everyone can benefit.

include {{ .PathToRepoRoot }}/scripts/common.mk
export PATH := $(REPO_ROOT)/.fogg/bin:$(PATH)

plan: set-eks-context
	@helm template -f variables.yaml . | kubectl --context='{{ .EKS.ClusterName }}' apply --dry-run -f -

apply: plan
	@echo -n "Apply? [yes/no]" && read ans && [ $${ans:-N} == yes ]
	@helm template -f variables.yaml . | kubectl --context='{{ .EKS.ClusterName }}' apply -f -

set-eks-context:
	aws --region {{ .AWSRegionProvider }} --profile {{ .AWSProfileProvider }} eks update-kubeconfig --name {{ .EKS.ClusterName }} --alias {{ .EKS.ClusterName }}
