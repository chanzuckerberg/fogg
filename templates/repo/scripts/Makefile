# Auto-generated by fogg. Do not edit
# Make improvements in fogg, so that everyone can benefit.
OS:=$(shell uname -s | tr '[:upper:]' '[:lower:]')
ifeq ($(shell uname -m),x86_64)
  ARCH ?= "amd64"
endif
ifeq ($(shell uname -m),i686)
  ARCH ?= "386"
endif
ifeq ($(shell uname -m),aarch64)
  ARCH ?= "arm"
endif

TF_PRESENT := $(shell command -v terraform 2> /dev/null)
TF_CURRENT_VERSION := $(shell terraform version | head -n1 | sed 's/Terraform v//g')
TF_VERSION := 0.11.8

TFLINT_PRESENT := $(shell command -v tflint 2> /dev/null)
TFLINT_VERSION :=

terraform-required:
ifndef TF_PRESENT
	$(error "Terraform is not installed")
endif
ifneq (${TF_VERSION},${TF_VERSION})
	$(error "Current Terraform version is ${TF_CURRENT_VERSION} but want ${TF_VERSION})
endif

tflint-required:
ifndef TFLINT_PRESENT
	$(error "tflint is not installed")
endif

install: install-terraform install-tflint

install-terraform:
	@echo "Installing Terraform ${TF_VERSION}"
	@wget -q -O /tmp/terraform.zip https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_${OS}_${ARCH}.zip
	@sudo unzip -d /usr/local/bin /tmp/terraform.zip && rm /tmp/terraform.zip

install-tflint:
	@echo "Installing tflint ${TFLINT_VERSION}"
  @wget -q -O /tmp/tflint.zip https://github.com/wata727/tflint/releases/download/v${TFLINT_VERSION}/tflint_${OS}_${ARCH}.zip
	@sudo unzip -d /usr/local/bin /tmp/tflint.zip && rm /tmp/tflint.zip
