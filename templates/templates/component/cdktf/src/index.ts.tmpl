{{ template "fogg_header_js" }}
import * as fs from "node:fs";
import * as path from "node:path";
import { App } from "cdktf";
import { ComponentStack } from "./stack";

const outdir = "cdktf.out";
const app = new App({
  outdir,
});
const stack = new ComponentStack(app, "fogg");
app.synth();

// Copy the generated Terraform code to the current directory to keep relative directory references
const stackSynthDir = path.join(
  outdir,
  app.manifest.forStack(stack).workingDirectory,
);

fs.cpSync(stackSynthDir, ".", { recursive: true });
fs.rmSync(outdir, { recursive: true });
if (process.env.CI) {
  fs.renameSync("cdk.tf.json", "ci-cdk.tf.json");
}
